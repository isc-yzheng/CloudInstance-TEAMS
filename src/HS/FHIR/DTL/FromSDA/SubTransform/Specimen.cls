Class HS.FHIR.DTL.FromSDA.SubTransform.Specimen Extends Ens.DataTransformDTL [ DependsOn = (HS.SDA3.Specimen, HS.FHIR.vDSTU2.Model.Resource.Specimen) ]
{

Parameter IGNOREMISSINGSOURCE = 1;

Parameter REPORTERRORS = 1;

Parameter TREATEMPTYREPEATINGFIELDASNULL = 0;

XData DTL [ XMLNamespace = "http://www.intersystems.com/dtl" ]
{
<transform sourceClass='HS.SDA3.Specimen' targetClass='HS.FHIR.vDSTU2.Model.Resource.Specimen' create='new' language='objectscript' >
<annotation>This transform uses the reserved DTL input parameter named &#39;aux&#39;.
For this transform, aux is a local array of strings.  The values held in aux were generated by the SDA to FHIR DTL framework prior to calling into this transform.
aux("PatientResourceId"): FHIR resource id for the patient represented by the Patient object in the SDA Container being transformed.</annotation>
<if condition='source.ExternalId &apos;= ""' >
<true>
<assign value='"official"' property='target.identifier.(1).use.value' action='set' />
<assign value='"ExternalId"' property='target.identifier.(1).type.text.value' action='set' />
<assign value='source.ExternalId' property='target.identifier.(1).value.value' action='set' />
</true>
</if>
<subtransform class='HS.FHIR.DTL.FromSDA.SubTransform.CodeTableTranslated' sourceObj='source.SpecimenType' targetObj='target.type' />
<subtransform class='HS.FHIR.DTL.FromSDA.SubTransform.PatientReference' targetObj='target.subject' sourceObj='target' aux='.aux' />
<assign value='##class(HS.FHIR.DTL.Utils).FHIRDateTime(source.EnteredOn)' property='target.receivedTime.value' action='set' />
<assign value='##class(HS.FHIR.DTL.Utils).FHIRDateTime(source.FromTime)' property='target.collection.collectedPeriod.start.value' action='set' />
<assign value='##class(HS.FHIR.DTL.Utils).FHIRDateTime(source.ToTime)' property='target.collection.collectedPeriod.end.value' action='set' />
<assign value='source.CollectionAmount' property='target.collection.quantity.value.value' action='set' />
<assign value='source.CollectionAmountUnits.Description' property='target.collection.quantity.unit.value' action='set' />
<assign value='##class(HS.FHIR.DTL.Utils).GetURIForCode(source.CollectionAmountUnits.SDACodingStandard)' property='target.collection.quantity.system.value' action='set' />
<assign value='source.CollectionAmountUnits.Code' property='target.collection.quantity.code.value' action='set' />
<subtransform class='HS.FHIR.DTL.FromSDA.SubTransform.CodeTableTranslated' sourceObj='source.CollectionMethod' targetObj='target.collection.method' />
<subtransform class='HS.FHIR.DTL.FromSDA.SubTransform.CodeTableTranslated' sourceObj='source.SpecimenSourceSite' targetObj='target.collection.bodySite' />
</transform>
}

}
